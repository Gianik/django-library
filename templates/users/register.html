{% extends "partials/base.html"%}
{% block content %}

    <div class="content-section">
        <form  name='registerform' method="POST" id="registerform"  novalidate >
            {% csrf_token %}

            <fieldset class="form-group"> 
                <legend class="border-bottom mb-4">Register</legend>
                <label for="email">Email:</label>
                <input type="email" id="email" name="email" value=""><br><br>
                <label for="fname">First Name:</label>
                <input type="text" id="fname" name="fname" value=""><br><br>
                <label for="lname">Last Name:</label>
                <input type="text" id="lname" name="lname" value=""><br><br>
                <label for="password1">Password 1:</label>
                <input type="password" id="password1" name="password1" value=""><br><br>
                <label for="password2">Password 2:</label>
                <input type="password" id="password2" name="password2" value=""><br><br>
            </fieldset>
            <div class="form-group">
                <button class="btn btn-outline-info" type="submit"  >Register</button>

            </div>

        </form>
        <div class="border-top pt-3">
            <small class="text-muted">Already Have An Account? <a class="ml-2" href="{% url 'login' %}">Sign In</a></small>
        </div>

    </div>

{% endblock content %}
{% block javascript %}
<script>
    $(document).ready(function(){
        var pk = {{pk}}
        $("#registerform").submit(function(event){

            let data={
                email:$('#email').val(),
                first_name:$('#fname').val(),
                last_name:$('#lname').val(),
                password:$('#password1').val(),
            }
    
            event.preventDefault();
            $.ajax({
                url:"http://127.0.0.1:8000/register-user/",
                type:"POST",
                dataType:"JSON",
                data:data,
                beforeSend: function (xhr){
                    xhr.setRequestHeader('X-CSRFToken', $('input[name=csrfmiddlewaretoken]').val());
                  },
                success:()=>{
                    window.location.replace("http://127.0.0.1:8000/login/")
                },
                error:(error)=>{
                    console.log(error)
                },
            });
        return false;
    });  
        
    })
    
    
    </script>

{% endblock %}
